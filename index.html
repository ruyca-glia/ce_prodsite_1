<!DOCTYPE html>
<html>
  <head>
    <script async src="https://api.glia.com/salemove_integration.js"></script>

    <script>
      window.smReady = function() {
        sm.getApi({ version: 'v1' }).then(function(salemove) {
          salemove.config.isCustomTheme = true;

          salemove.config.reactiveTabVisuals = {
            backColor: "#0000FF",
            frontColor: "#FF0000",
            fontSize: 14,
            format: "text",
            iconType: "text",
            placement: "right",
            size: 80,
            text: "Click Me!",
            verticalOffset: 100,
            visibleOperatorCount: 1
          };
          console.log("Glia SDK configuration applied.");

          // --- NEW CODE: Attach event listener to our custom button ---
          const videoBtn = document.getElementById('start-video-btn');
          if (videoBtn) {
            videoBtn.addEventListener('click', function() {
              // The SDK handles the API calls and authorization automatically
              salemove.requestEngagement('video')
                .then(function() {
                  console.log('Video engagement request sent successfully!');
                })
                .catch(function(error) {
                  console.error('Failed to request video engagement:', error);
                });
            });
          }
        });
      };

      if (window.sm) {
        smReady();
      } else {
        window.addEventListener('sm.initialized', smReady);
      }
    </script>

    <title>CE Testing Site</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <style>
      h1 { color:#7C19DD; font-family:roboto; text-align:center; }
      img { width:50%; display: block; margin: 0 auto; }
      .nav-container { text-align: center; margin-top: 20px; }
      .btn {
        padding: 10px 20px;
        background-color: #7C19DD;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        font-family: roboto, sans-serif;
        border: none;
        cursor: pointer;
        font-size: 16px;
      }
      .btn:hover { background-color: #5a12a3; }
    </style>
    <link rel="stylesheet" href="./static/css/styles.css">
    <script type="text/javascript" src="./static/js/client-app.js" defer></script>
  </head>

  <body>
    <center>
      <img src="images/Full LOGO_black.png" alt="CE logo" style="width:750px">
    </center>

    <h1 id="title" class="title">Welcome to our PROD site!</h1>

    <div class="nav-container">
      <button id="start-video-btn" class="btn">Start Video Engagement</button>
    </div>

    <div class="nav-container">
      <a href="/static/other_page.html" class="btn">Go to Cat Facts</a>
    </div>

    <div class="nav-container">
      <a href="./static/desafilacion.html" id="redirect-link" class="btn">Go to desafilacion</a>
    </div>

    <dialog id="tos-modal">
      <h2>Terms of service</h2>
      <p>By continuing, you agree to our terms and conditions.</p>
      <div class="actions">
        <button id="cancel-btn">Cancel</button>
        <button id="accept-btn">I accept</button>
      </div>
    </dialog>
  </body>
</html>